[["index.html", "Hands-on Analysis on Single Cell Multiome Chapter 1 Prerequisites 1.1 About Data 1.2 Server environment requirements 1.3 R libraries 1.4 Construct folder structure in Terminal 1.5 Accessing pancreas data", " Hands-on Analysis on Single Cell Multiome Danni Liu 2024-06-06 Chapter 1 Prerequisites 1.1 About Data The data used in this hands-on tutorial is a public single cell ‘multiome’ dataset of cryopreserved human peripheral blood mononuclear cells (PBMC) from 10x Genomics. This dataset is collected from a 25-year-old healthy female donor with around 10,000 cells, and scRNA-seq and scATAC-seq profiles were simultaneously sequenced from the same cells. You can find all information about this data and Cell Ranger ARC output reports from 10x Genomics website. In this hands-on tutorial, we present a complete workflow for analyzing multiome data starting from sequencing data, with an additional section for data integration of multiomics datasets that are collected from different experiments. We will demonstrate how to preprocess raw sequencing data using Cell Ranger ARC, perform data quality control, cluster and annotate cell types, and identify marker genes using differential expression (DE) analysis. Then we will treat the two profiles of scRNA-seq and scATAC-seq as originating from two separate experiments, and perform data integration. Since they were originally measured in the same cells, this provides a ground truth that we can use to assess the accuracy of integration. The PBMC dataset is used here for illustration purpose. For hands-on practice, please try to apply the pipeline in this tutorial on the mice pancreatic data. This can be an experience that highly assembles the real-world data analysis process, where we apply an existing pipeline from a publication to a new target dataset and make modifications of the pipeline to fit for our purpose. 1.2 Server environment requirements We will use the UCI HPC3 environment for analysis. Please navigate to the JypyterHub portal, and start a container under the one with ** *CaSB Short Course which has “R4.3.3” and required R packages installed in the environment. Please request 4-8 CPU cores, with 6Gb of memory** for each core. Also please check the last box “Enable full HPC3 software stack (overide container stack)” if you want to try running cellranger-arc. Figure 1.1: JupyterHub server setting Once the server started, click to open “Rstudio” app or a “Notebook” app under R kernel. 1.3 R libraries If you want to run analysis using your own laptop, please make sure you have the latest R and RStudio installed. You can refer to RStudio website for installation instructions. Below are the codes needed to install the necessary R packages if you are using your laptop. Seurat and Signac are the major packages for analysis in this tutorial. # Enter commands in R (or R studio, if installed) install.packages(&#39;Seurat&#39;) library(Seurat) #install.packages(&quot;devtools&quot;) #library(devtools) #devtools::install_github(&#39;satijalab/seurat-data&#39;) setRepositories(ind=1:3) # needed to automatically install Bioconductor dependencies install.packages(&quot;Signac&quot;) if (!requireNamespace(&quot;remotes&quot;, quietly = TRUE)) { install.packages(&quot;remotes&quot;) } remotes::install_github(&quot;mojaveazure/seurat-disk&quot;) # Installing genome assembly and gene annotation packages if (!require(&quot;BiocManager&quot;, quietly = TRUE)) install.packages(&quot;BiocManager&quot;) BiocManager::install(c(&#39;BSgenome.Hsapiens.UCSC.hg38&#39;, &#39;EnsDb.Hsapiens.v86&#39;)) # install other packages needed. install.packages(&quot;hdf5r&quot;) BiocManager::install(&quot;biovizBase&quot;) BiocManager::install(&quot;glmGamPoi&quot;) install.packages(&quot;dplyr&quot;) install.packages(&quot;clustree&quot;) BiocManager::install(&quot;TFBSTools&quot;) BiocManager::install(&quot;JASPAR2020&quot;) BiocManager::install(&quot;BiocParallel&quot;) BiocManager::install(&quot;motifmatchr&quot;) install.packages(&#39;ggseqlogo&#39;) # install.packages(&quot;VariantAnnotation_1.50.0.tgz&quot;, repos = NULL, type=&quot;source&quot;) Seurat installation: https://satijalab.org/seurat/articles/install_v5 Signac installation: https://stuartlab.org/signac/articles/install SeuratData installation: https://github.com/satijalab/seurat-data 1.4 Construct folder structure in Terminal Some basic bash/shell commands # check where you are at pwd # create directory mkdir new_folder # list all files in directory ls ls new_folder # copy file cp file newfolder/file #remove file--can&#39;t recover once removed rm file # count number of lines wc -l file # count number of columns head -1 file | awk &#39;{print NF}&#39; Navigate to the working directory, with 1TB of storage. cd /dfs6/pub/your_username pwd # check the current directory path ls # list all files in current directory 1.5 Accessing pancreas data The sequencing data was processed using cellranger-arc so you will directly load the output file into R. The data was saved in /commondata/workshop/.... You can copy the data to your working directory. scp -r .../Pancreas1 /dfs6/pub/your_username/. ls Pancreas1/outs/ "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
